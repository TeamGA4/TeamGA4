#include <stdlib.h>
#include <iostream>

#include "DxLib.h"
#include "Header.h"

using namespace std;

enum Scene game_scene = SceneMusicSelect;

//メイン
int WINAPI WinMain(HINSTANCE hInstance, 
	HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
	//windowの設定

	//SetMainWindowText("ああああ"); //windowの名前
	ChangeWindowMode(TRUE); //windowモード
	SetGraphMode(WINDOW_SIDE, WINDOW_VERTICAL, 32); //windowサイズ
	SetAlwaysRunFlag(TRUE); //バックグラウンドでも動くように設定
	SetDoubleStartValidFlag(TRUE); //多重起動の許可

	//dxライブラリ初期化
	if (DxLib_Init() == -1) return -1; //エラーが起きたら終了

	//描画先の変更
	SetDrawScreen(DX_SCREEN_BACK);

	//クラスの作成
	CharaSelect* charaselect = new CharaSelect();

	MusicSelect* music_select = new MusicSelect();

	char music_name[] = "Battle";
	MusicGame* music_game = new MusicGame(music_name, 5);

	//メインループ
	while (CheckHitKey(KEY_INPUT_ESCAPE) == 0)
	{
		if (ProcessMessage() == -1)
			break;

		switch (game_scene)
		{
		case Charaselect:
		{
			charaselect->Action();
			charaselect->Draw();
			break;
		}

		case SceneMusicSelect:
		{
			music_select->Action();
			music_select->Draw();
			break;
		}

		case SceneMusicGame:
		{
			music_game->Action();
			music_game->Draw();
			break;
		}

		default:
			break;
		}

		//画面の更新
		ScreenFlip();
		ClearDrawScreen();

		wait_flame();
	}

	DxLib_End();

	return 0;//ソフトの終了
}